<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/static/img/Logo.ico">
    <link rel="stylesheet" href="/static/css/style_eliminar_cuenta.css">
    <title>GlobalArg</title>
</head>

<header>
    <div class="banda_celeste">
        <img class="logo" src="/static/img/Logo.svg" alt="Logo" >
        <p class="nombre_encabezado"><span id="G">G</span>lobal<span id="A">A</span>rg</p>
    </div>
</header>
 
<body id="pagina_web">

    <div class="columna_imagen_izquierda">
        <img src="/static/img/Mapa Mundo Izquierda.svg" alt="fondo_mundo" />
    </div>

    <div class="contenedor_principal">

        <a id="flecha_retroceder">
            <img class="fecha_retroceder" src="/static/img/Flecha retroceder.svg" alt="Volver" />
        </a>

        <div class="logo_principal">
            <img id="logo.png" src="/static/img/Logo.svg" alt="Logo" height="350px"></a>
        </div>

        <form id="formulario" method="get">
            <div class="formulario"">

                <h1 class="titulo">Eliminar Cuenta</h1>
                <p class="subtitulo">- Ingrese su usuario y clave -</p>

                <label for="usuario">Usuario:</label>
                <input type="text" id="usuario" name="usuario"/>
                <div class="errores">
                    <span id="error_usuario"></span>
                </div>

                <label for="password">Clave:</label>
                <input type="int" id="password" name="clave"/>
                <div class="errores">
                    <span id="error_password"></span>
                </div>
                </div>
            
            <button id="continuar" type="submit" class="boton_continuar">Eliminar</button>
        </form>


    </div>

    <div class="columna_imagen_derecha">
        <img src="/static/img/Mapa Mundo derecha.svg" alt="fondo_mundo" />
    </div>
    

    <script>
        document.getElementById("continuar").addEventListener("click", function() {
            window.location.href = "/";  
        });
        document.getElementById("flecha_retroceder").addEventListener("click", function() {
                            window.location.href = "/ajustes_varios";  
                            });

        const usuario=document.getElementById('usuario').value;
        const clave=document.getElementById('password').value;
        const id=localStorage.getItem('id');
    
document.getElementById("formulario").addEventListener("submit", function(e) {
    e.preventDefault();
    if (!usuario===''){
    fetch(`/api/usuarios/${id}/eliminar`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
        usuario: usuario,
        clave: clave
    })
})
.then(res => res.json())
.then(data => {
    if (data.mensaje === "Cuenta eliminada correctamente") {
        alert("Cuenta eliminada");
        localStorage.clear();
        // window.location.href = "/";  
    } else {
        alert("Error al eliminar cuenta: " + data.error);
    }
})
.catch(err => {
    console.error("Error en la solicitud:", err);
});
    }

});
    
    </script>


</body>

<footer>
    <div class="banda_celeste"></div>
</footer>

</html>